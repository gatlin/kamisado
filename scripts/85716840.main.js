!function(){"use strict";function a(a,b){return b>a?a:b}function b(a,b){this.x=a,this.y=b}function c(a,c){var d=a.getBoundingClientRect();return new b(c.clientX-d.left,c.clientY-d.top)}function d(a,b,c,d){this.board=a,this.pos=b,this.selected="undefined"!=typeof c?c:null,this.player="undefined"!=typeof d?d:0}function e(a){this.unsafePerformIO=a}function f(){return new e(function(){var a,c=[];for(a=1;q-1>a;a++)c[a]=[].repeat(0,8);return c[0]=[1,2,3,4,5,6,7,8],c[7]=[16,15,14,13,12,11,10,9],new d(c,new b(0,0))})}function g(a){var b=a.extract(),c=r[s[a.pos.y][a.pos.x]];if(n.fillStyle=c,n.fillRect(a.pos.x*i,a.pos.y*i,i,i),0===b)return b;var d=a.pos.x+1,e=a.pos.y+1,f={x:d*i-i/2,y:e*i-i/2},g=b>q?r[9]:r[8],h=r[(b-1)%8];return n.beginPath(),n.arc(f.x,f.y,j,0,2*Math.PI,!1),n.closePath(),n.fillStyle=g,n.fill(),n.strokeStyle=g,n.stroke(),n.beginPath(),n.arc(f.x,f.y,.75*j,0,2*Math.PI,!1),n.closePath(),n.fillStyle=h,n.fill(),n.strokeStyle=h,n.stroke(),null!==a.selected&&a.selected.x===a.pos.x&&a.selected.y===a.pos.y&&(n.beginPath(),n.arc(f.x,f.y,.5*j,0,2*Math.PI,!1),n.fillStyle=g,n.fill(),n.strokeStyle=g,n.stroke()),b}function h(a){return new e(function(){n.canvas.addEventListener("click",function(b){var d=c(this,b);d.x=Math.floor(d.x/i),d.y=Math.floor(d.y/i),a.clicked(d).drawCells()})})}var i,j,k,l,m=document.getElementById("board"),n=m.getElementsByTagName("canvas")[0].getContext("2d"),o=window.innerWidth,p=window.innerHeight,q=8,r=["#F5B437","#3340AE","#1E8AD1","#F8D6C4","#F6E500","#DC442F","#BAD360","#6B451E","#080D07","#F4FFF4"],s=[[0,1,2,3,4,5,6,7],[5,0,3,6,1,4,7,2],[6,3,0,5,2,7,4,1],[3,2,1,0,7,6,5,4],[4,5,6,7,0,1,2,3],[1,4,7,2,5,0,3,6],[2,7,4,1,6,3,0,5],[7,6,5,4,3,2,1,0]];Array.prototype.repeat=function(a,b){for(;b;)this[--b]=a;return this},d.prototype.updatePos=function(a){return this.pos=a,this},d.prototype.extract=function(){return this.board[this.pos.y][this.pos.x]},d.prototype.extend=function(a){var c,e,f=[];for(e=0;e<this.board.length;e++)for(f[e]=[],c=0;c<this.board[e].length;c++)f[e][c]=a(new d(this.board,new b(c,e),this.selected,this.player));return this.board=f,this},d.prototype.drawCells=function(){return this.extend(g)},d.prototype.clicked=function(a){var c=this.updatePos(a).extract();if(null===this.selected&&(this.selected=new b(-1,-1)),this.selected.x===a.x&&this.selected.y===a.y)return this;if(c>0&&(this.selected=a),0===c){this.board[a.y][a.x]=this.board[this.selected.y][this.selected.x],this.board[this.selected.y][this.selected.x]=0,this.selected.x=a.x,this.selected.y=a.y,this.player=this.player?0:1,console.log("moved. switched to player "+this.player);var d,e,f,g=s[this.selected.y][this.selected.x],h=g+1+8*this.player;for(e=0;e<this.board.length;e++)for(d=0;d<this.board[e].length;d++)if(f=this.board[e][d],f===h){this.selected.x=d,this.selected.y=e;break}}return this},e.of=function(a){return new e(function(){return a})},e.prototype.chain=function(a){var b=this;return new e(function(){return a(b.unsafePerformIO()).unsafePerformIO()})},e.prototype.fork=function(){var a=this;return new e(function(){setTimeout(function(){a.unsafePerformIO()},0)})},k=new e(function(){n.canvas.width=.9*a(o,p),n.canvas.height=n.canvas.width,i=.9*a(o,p)/q,j=.9*i/2}),l=k.chain(f).chain(function(a){return new e.of(a.drawCells())}).chain(h),l.unsafePerformIO()}();